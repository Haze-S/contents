---
date: '2024-05-25'
title: '[DB] GraphQL'
categories: ['Review']
tags: ['Blog', 'language']
summary: 'GraphQL은 클라이언트가 데이터를 서버로부터 가져오는 것을 목적으로 한다.'
thumbnail: 'https://github.com/Haze-S/contents/assets/87344625/1ef64a06-b669-441a-892f-dc87a7002b3b'
---

개츠비를 이용한 블로그를 만들면서 처음 Graph QL을 사용해보게 되었다. MySQL을 주로 썼던 나는 `SELETE` 문과 같은 예약어가 없이 마치 JSON 처럼 이루어진 쿼리가 당황스럽긴 했지만 이번 기회에 GraphQL은 어떤 배경을 가지고 만들어진 기술인지 한번 정리해본다.

## GraphQL이란

공식 홈페이지에서는 GraphQL을 아래와 같이 설명한다.

> _"GraphQL은 API를 위한 쿼리 언어이며 이미 존재하는 데이터로 쿼리를 수행하기 위한 런타임 입니다. GraphQL은 API에 있는 데이터에 대한 완벽하고 이해하기 쉬운 설명을 제공하고 클라이언트에게 필요한 것을 정확하게 요청할 수 있는 기능을 제공하며 시간이 지남에 따라 API를 쉽게 진화시키고 강력한 개발자 도구를 지원합니다."_

GraphQL은 Facebook에서 개발된 오픈소스 기술로 데이터 질의 (Query + Schema) 언어이다. 쿼리 언어라는 설명때문에 SQL과 비교를 하게 되었는데, 이 둘은 만들어진 목적이 다르다.

GraphQL 은 웹 클라이언트가 데이터를 서버로부터 효율적으로 가져오는 것이 목적인 쿼리 언어이고 SQL 은 데이터베이스 시스템에 저장된 데이터를 효율적으로 가져오는 것이 목적인 쿼리 언어이다. 클라이언트는 GraphQL 서버로 쿼리를 전송하고, 서버는 해당 쿼리를 해석하고 데이터를 반환한다. 이 때, 클라이언트가 요청한 필드만 반환되므로 over fetching을 줄여 효율적이다.

또한, GraphQL은 스키마를 사용하여 데이터 모델을 정의하기 때문에 클라이언트와 서버 간의 일관성 있는 데이터 통신을 보장한다. 이를 통해 클라이언트가 서버가 제공하는 데이터 중 원하는 데이터를 가져오는 것이 가능해진다. GraphQL은 특정한 데이터베이스나 특정한 스토리지 엔진과 관계되어 있지 않으며 기존 코드와 데이터에 의해 대체된다.

## GraphQL vs REST API

REST API 는 URL + METHOD 를 조합하기 때문에 정말 다양한 엔드포인트가 존재하지만,
GraphQL 은 엔드포인트가 하나만 존재한다. `/graphql` 이라는 하나의 엔드포인트를 가지고, 쿼리 조합을 통해 데이터를 요청하기 때문에 API 가 점점 늘어남에 따라 URL 을 설계하고 만들어주지 않아도 된다. 그리고 요청 시 body에 Schema에 맞춰 Query를 사용하여 요청하기 때문에 일관성 있는 통신이 가능하다.

![graphql-api](https://github.com/Haze-S/contents/assets/87344625/89c81caa-cc66-4c41-ac68-ed517a6ac641)

REST API 의 경우 return 되는 response 데이터가 정해져 있다. 그렇기 때문에 이전 API response 에 다른 컬럼들이 추가되면 해당 파일을 계속 수정해줘야하고, API 별로 response 가 다 다르면 그에 따른 DTO 를 각각 다 만들어줘야 한다. 하지만, GraphQL 은 쿼리로 요청하기 때문에 클라이언트가 원하는 데이터를 쏙쏙 뽑아 커스터마이징 해서 사용할 수 있다.

## GraphQL의 장단점

GraphQL은 많은 장점이 있지만, 단점도 잘 이해하고 적절히 관리해야 한다.

### 장점

- 유연한 데이터 요청
  - 클라이언트가 필요한 데이터만 요청할 수 있어 불필요한 데이터 전송을 줄인다. 이는 네트워크 성능 향상에 기여한다.
- 단일 엔드포인트
  - 모든 데이터 요청을 단일 엔드포인트로 처리할 수 있어 API 관리가 단순해진다.
- 타입 시스템
  - GraphQL의 타입 시스템을 통해 API 문서화가 쉬워지고, 클라이언트와 서버 간의 데이터 계약이 명확해진다.
- API 진화 용이성
  - 기존 API를 깨뜨리지 않고 새로운 필드를 추가할 수 있어, API 진화가 쉽다.
- 다중 자원 요청
  - 단일 요청으로 여러 자원에서 데이터를 가져올 수 있어, 네트워크 요청 수를 줄일 수 있다.

### 단점

- 복잡한 쿼리 최적화
  - 클라이언트가 어떤 데이터를 요청할지 예측하기 어려워, 서버 측에서 쿼리 최적화가 복잡할 수 있다. N+1 문제와 같은 성능 이슈가 발생할 수 있다.
- 초기 설정 및 학습 곡선
  - GraphQL의 설정과 사용 방법을 배우는 데 시간이 걸린다. 특히, 기존 REST API에서 전환하는 경우에는 학습 곡선이 있을 수 있다.
- 캐싱 문제
  - REST API와 달리, URL이 아닌 쿼리 내용에 따라 데이터를 요청하므로 전통적인 HTTP 캐싱 전략을 적용하기 어렵다.
- 서버 리소스 사용 증가
  - 클라이언트가 복잡한 쿼리를 만들면 서버에서 이를 처리하는 데 많은 리소스가 필요할 수 있다.
- 보안 문제
  - 클라이언트가 복잡한 쿼리를 만들어 서버 리소스를 과도하게 사용하는 것을 방지하기 위한 추가적인 보안 대책이 필요하다. 예를 들어, 쿼리 깊이 제한이나 쿼리 복잡도 제한 등을 설정해야 한다.

---

ref.
[Kakao tech - GraphQL 개념잡기](https://tech.kakao.com/posts/364)
